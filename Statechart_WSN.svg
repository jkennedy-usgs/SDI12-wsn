<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg height="439" version="1.1" width="979" xmlns="http://www.w3.org/2000/svg">
<rect fill="#00ff" height="128" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="264" x="24" y="14"/>
<rect fill="#ffffff" height="128" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="264" x="24" y="14"/>
<rect fill="#ffffff" height="128" rx="16" ry="16" stroke="#000000" stroke-width="1" width="264" x="24" y="14"/>
<text font-family="Dialog" font-size="12" x="78" y="28">
WSN_waiting_for_message</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="24" x2="287" y1="38" y2="38"/>
<text font-family="Dialog" font-size="12" x="26" y="51">
Start UART timer</text>
<text font-family="Dialog" font-size="12" x="26" y="67">
On timeout:</text>
<text font-family="Dialog" font-size="12" x="26" y="83">
log error</text>
<text font-family="Dialog" font-size="12" x="26" y="99">
current_node++</text>
<text font-family="Dialog" font-size="12" x="26" y="115">
Automatic retries are handled by XBee firmware</text>
<rect fill="#00ff" height="62" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="218" x="24" y="166"/>
<rect fill="#ffffff" height="62" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="218" x="24" y="166"/>
<rect fill="#ffffff" height="62" rx="16" ry="16" stroke="#000000" stroke-width="1" width="218" x="24" y="166"/>
<text font-family="Dialog" font-size="12" x="73" y="180">
WSN_probes_are_on</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="24" x2="241" y1="190" y2="190"/>
<text font-family="Dialog" font-size="12" x="26" y="203">
warmup delay</text>
<text font-family="Dialog" font-size="12" x="26" y="219">
WSN_sample_probes()</text>
<rect fill="#00ff" height="78" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="176" x="64" y="246"/>
<rect fill="#ffffff" height="78" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="176" x="64" y="246"/>
<rect fill="#ffffff" height="78" rx="16" ry="16" stroke="#000000" stroke-width="1" width="176" x="64" y="246"/>
<text font-family="Dialog" font-size="12" x="86" y="260">
WSN_sample_is_ready</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="64" x2="239" y1="270" y2="270"/>
<text font-family="Dialog" font-size="12" x="66" y="283">
Log sample</text>
<text font-family="Dialog" font-size="12" x="66" y="299">
Display on LCD</text>
<text font-family="Dialog" font-size="12" x="66" y="315">
WSN_turn_off_probes()</text>
<rect fill="#00ff" height="46" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="131" x="112" y="342"/>
<rect fill="#ffffff" height="46" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="131" x="112" y="342"/>
<rect fill="#ffffff" height="46" rx="16" ry="16" stroke="#000000" stroke-width="1" width="131" x="112" y="342"/>
<text font-family="Dialog" font-size="12" x="118" y="356">
WSN_probes_are_off</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="112" x2="242" y1="366" y2="366"/>
<text font-family="Dialog" font-size="12" x="114" y="379">
current_node++</text>
<rect fill="#00ff" height="62" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="124" x="440" y="222"/>
<rect fill="#ffffff" height="62" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="124" x="440" y="222"/>
<rect fill="#ffffff" height="62" rx="16" ry="16" stroke="#000000" stroke-width="1" width="124" x="440" y="222"/>
<text font-family="Dialog" font-size="12" x="465" y="236">
WSN_asleep</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="440" x2="563" y1="246" y2="246"/>
<text font-family="Dialog" font-size="12" x="442" y="259">
Decrement LCD timer</text>
<rect fill="#00ff" height="64" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="184" x="392" y="342"/>
<rect fill="#ffffff" height="64" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="184" x="392" y="342"/>
<rect fill="#ffffff" height="64" rx="16" ry="16" stroke="#000000" stroke-width="1" width="184" x="392" y="342"/>
<text font-family="Dialog" font-size="12" x="417" y="356">
WSN_message_waiting</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="392" x2="575" y1="366" y2="366"/>
<text font-family="Dialog" font-size="12" x="394" y="379">
Reset and turn off UART timer</text>
<text font-family="Dialog" font-size="12" x="394" y="395">
wireless_parse_message()</text>
<rect fill="#00ff" height="46" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="185" x="416" y="166"/>
<rect fill="#ffffff" height="46" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="185" x="416" y="166"/>
<rect fill="#ffffff" height="46" rx="16" ry="16" stroke="#000000" stroke-width="1" width="185" x="416" y="166"/>
<text font-family="Dialog" font-size="12" x="426" y="180">
WSN_awake_done_sampling</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="416" x2="600" y1="190" y2="190"/>
<polyline fill="none" points="564,238 600,238 600,358 576,358" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="588" x2="576" y1="351" y2="358"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="588" x2="576" y1="365" y2="358"/>
<polyline fill="none" points="392,406 48,406 48,228" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="55" x2="48" y1="240" y2="228"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="41" x2="48" y1="240" y2="228"/>
<text font-family="Dialog" font-size="12" x="47" y="421">
State determined by message</text>
<polyline fill="none" points="392,406 96,406 96,324" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="103" x2="96" y1="336" y2="324"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="89" x2="96" y1="336" y2="324"/>
<polyline fill="none" points="392,406 144,406 144,388" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="151" x2="144" y1="400" y2="388"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="137" x2="144" y1="400" y2="388"/>
<polyline fill="none" points="48,166 48,142" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="55" x2="48" y1="154" y2="142"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="41" x2="48" y1="154" y2="142"/>
<polyline fill="none" points="240,262 264,262 264,142" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="271" x2="264" y1="154" y2="142"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="257" x2="264" y1="154" y2="142"/>
<polyline fill="none" points="392,406 360,406 360,238 440,238" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="428" x2="440" y1="245" y2="238"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="428" x2="440" y1="231" y2="238"/>
<polyline fill="none" points="601,182 616,182 616,374 576,374" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="588" x2="576" y1="367" y2="374"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="588" x2="576" y1="381" y2="374"/>
<polyline fill="none" points="288,22 632,22 632,390 576,390" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="588" x2="576" y1="383" y2="390"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="588" x2="576" y1="397" y2="390"/>
<text font-family="Dialog" font-size="12" x="635" y="266">
UART_RX_Interrupt determines a valid message is received</text>
<rect fill="#00ff" height="104" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="288" x="312" y="38"/>
<rect fill="#ffffff" height="104" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="288" x="312" y="38"/>
<rect fill="#ffffff" height="104" rx="16" ry="16" stroke="#000000" stroke-width="1" width="288" x="312" y="38"/>
<text font-family="Dialog" font-size="12" x="377" y="52">
WSN_awake_and_sampling</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="312" x2="599" y1="62" y2="62"/>
<rect fill="#00ff" height="46" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="115" x="472" y="78"/>
<rect fill="#ffffff" height="46" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="115" x="472" y="78"/>
<rect fill="#ffffff" height="46" rx="16" ry="16" stroke="#000000" stroke-width="1" width="115" x="472" y="78"/>
<text font-family="Dialog" font-size="12" x="478" y="92">
All nodes sampled</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="472" x2="586" y1="102" y2="102"/>
<rect fill="#00ff" height="46" rx="16" ry="16" stroke="#00ff" stroke-width="1" width="135" x="328" y="78"/>
<rect fill="#ffffff" height="46" rx="16" ry="16" stroke="#ffffff" stroke-width="1" width="135" x="328" y="78"/>
<rect fill="#ffffff" height="46" rx="16" ry="16" stroke="#000000" stroke-width="1" width="135" x="328" y="78"/>
<text font-family="Dialog" font-size="12" x="338" y="92">
Nodes left to sample</text>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="328" x2="462" y1="102" y2="102"/>
<text font-family="Dialog" font-size="12" x="330" y="115">
WSN_turn_on_probes()</text>
<polyline fill="none" points="243,358 336,358 336,142" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="343" x2="336" y1="154" y2="142"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="329" x2="336" y1="154" y2="142"/>
<polyline fill="none" points="528,124 528,166" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="521" x2="528" y1="154" y2="166"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="535" x2="528" y1="154" y2="166"/>
<polyline fill="none" points="328,94 288,94" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="300" x2="288" y1="87" y2="94"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="300" x2="288" y1="101" y2="94"/>
<ellipse cx="368" cy="182" fill="#000000" rx="8.0" ry="8.0" stroke="#000000" stroke-width="1"/>
<polyline fill="none" points="376,182 416,182" stroke="#000000" stroke-width="1"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="404" x2="416" y1="189" y2="182"/>
<line fill="#000000" stroke="#000000" stroke-width="1" x1="404" x2="416" y1="175" y2="182"/>
</svg>
